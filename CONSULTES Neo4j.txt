CONSULTES Neo4j

# 3

MATCH (i:Individu)-[v:viu]->(h:Habitatge)
WHERE h.Municipi = 'SFLL' AND i.Year > 1800 AND i.Year < 1845
RETURN COUNT(DISTINCT i) AS Poblacio, i.Year AS Any_Padro, COLLECT(DISTINCT h.Id_Llar) AS Habitatges
ORDER BY i.Year

#5

MATCH (i:Individu)-[s:SAME_AS]-(r:Individu)
WHERE i.name = "miguel" AND i.surname = "estape" AND i.second_surname = "bofill"
RETURN i, s, r

#6

MATCH (i:Individu)-[s:SAME_AS]-(r:Individu)
WHERE i.name = "miguel" AND i.surname = "estape" AND i.second_surname = "bofill"
RETURN i.name as Nom, COLLECT(DISTINCT r.surname) as Cognom1, COLLECT(DISTINCT r.second_surname) as Cognom2

# 7

MATCH (i:Individu {name: 'benito', surname: 'julivert'})
OPTIONAL MATCH (i)-[f:familia]->(p:Individu)
RETURN p.name AS name, p.surname AS cognom1, p.second_surname AS cognom2, f.Relacio AS tipus_relaciÃ³

#9

MATCH (I:Individu)-[f:familia]->(s:Individu)
RETURN I.name as individu_1, f.Relacio as relacio_familiar, s.name as individu_2

# 11

MATCH (i:Individu)-[f:familia {Relacio: 'jefe'}]->(i)
WHERE EXISTS((i)-[:viu]->(:Habitatge {Municipi: 'CR'}))
WITH i, size([(i)-[:familia {Relacio: 'fill'}]->() | 1]) + size([(i)-[:familia {Relacio: 'filla'}]->() | 1]) AS num_fills
WHERE num_fills > 3
RETURN i.name AS nom, i.surname AS cognom1, i.second_surname AS cognom2, num_fills
ORDER BY num_fills DESC
LIMIT 20
